
(function(){var PromiseManager,cssPromiseManager;var __hasProp=Object.prototype.hasOwnProperty,__slice=Array.prototype.slice;this.U=_.noConflict();jQuery.fn.unhide=function(fadeSpeed){return $(this).removeClass('hidden').hide().fadeIn(fadeSpeed);};jQuery.fn.isLoading=function(value){return $(this).data('isLoading',value);};jQuery.fn.isFormFilled=function(failureMessage){var field,_i,_len,_ref;_ref=$(this).find(':input');for(_i=0,_len=_ref.length;_i<_len;_i++){field=_ref[_i];if($.trim($(field).val()).length===0){OF.alert('Missing Data',failureMessage||'Please fill out all form fields.');return false;}}
return true;};jQuery.lazyLoad=function(options){var isEmpty,isFinished,nextPageLoaded,nextPageShouldLoad,pageHandler,self,startPage,threshold;self=OF.page.eventHandle();startPage=options.startPage||1;threshold=options.threshold||0.5;nextPageLoaded=options.nextPageLoaded;nextPageShouldLoad=options.nextPageShouldLoad;isEmpty=options.isEmpty;isFinished=options.isFinished;pageHandler=function(page,data,forceFinish){var finished;finished=forceFinish||data.length===0;if(finished){if(page===1){if(typeof isEmpty==="function"){isEmpty();}}
if(typeof isFinished==="function"){isFinished();}
jQuery(self).unbind("scroll.lazyLoader");}
if(data!=null){nextPageLoaded(page,data);}
jQuery(self).data("lazyLoader-lastLoadedPage",page);return U.defer(function(){return jQuery(self).data("lazyLoader-isLoading",false);});};jQuery(self).data("lazyLoader-isLoading",true);nextPageShouldLoad(startPage,pageHandler.curry(startPage));return jQuery(self).bind("scroll.lazyLoader",function(){var nextPage,scrollBottom,triggerLine;scrollBottom=jQuery(document).scrollTop()+jQuery(window).height();triggerLine=jQuery(document).height()-(jQuery(window).height()*threshold);if(scrollBottom<triggerLine){return;}
if(jQuery(self).data("lazyLoader-isLoading")){return;}
nextPage=(jQuery(self).data("lazyLoader-lastLoadedPage")||startPage)+1;jQuery(self).data("lazyLoader-isLoading",true);return nextPageShouldLoad(nextPage,pageHandler.curry(nextPage));});};jQuery.renderCollection=function(partialName,items,innerKey){var html,index,item,key,keys,obj,theTmpl,_i,_len;if(!(items.length>0)){return'';}
theTmpl=tmpl(partialName);if(!innerKey){keys=(function(){var _ref,_results;_ref=items[0];_results=[];for(key in _ref){if(!__hasProp.call(_ref,key))continue;_results.push(key);}
return _results;})();if(keys.length>1){OF.log("ERROR: Ambiguous inner keys ["+(keys.join(', '))+"]. Specify what key to use if there is more than one.");return;}
if(keys.length===0){OF.log('ERROR: Cannot render empty object.');}
innerKey=keys[0];}
index=0;html='';for(_i=0,_len=items.length;_i<_len;_i++){item=items[_i];obj=item[innerKey];obj.index||(obj.index=index);obj.position||(obj.position=obj.index+1);index+=1;html+=theTmpl(obj);}
return $(html);};jQuery.htmlEncode=function(value){return $('<div>').text(value).html();};jQuery.htmlDecode=function(value){return $('<div>').html(value).text();};jQuery.fn.hasLive=function(type,ctx){var events,handler,handlers,_i,_len;if(ctx==null){ctx=document;}
events=$(ctx).data('events');if(handlers=events&&events[type]){for(_i=0,_len=handlers.length;_i<_len;_i++){handler=handlers[_i];if(this.is(handler.selector)){return true;}}}
return false;};jQuery.loadScript=function(path){return $.ajax({url:"javascripts/"+path+".js?"+(new Date().getTime()),dataType:'script',async:false});};jQuery.loadCss=function(path,async){return $.ajax({url:"stylesheets/"+path+".css?"+(new Date().getTime()),async:async!=null?async:true,success:function(data){console.error('CSS LOADED');return $('<style></style>').attr('type','text/css').attr('id',""+path+"_css").html(data).appendTo('head');}});};PromiseManager=(function(){function PromiseManager(name){this.name=name;this.promises={};}
PromiseManager.prototype.set=function(identifier,promise){return this.promises[identifier]=promise;};PromiseManager.prototype.getPromise=function(identifier,factory){var promise;if(!(identifier in this.promises)){promise=factory(identifier);this.promises[identifier]=promise;}
return this.promises[identifier];};return PromiseManager;})();cssPromiseManager=new PromiseManager('css');(function($){var loadCss,removeCss,requireCss,_applyCss,_getAllPromises,_styleIdForPath;_styleIdForPath=function(path){var styleId;return styleId=""+(path.replace(/\//g,'-'))+"_css";};_applyCss=function(data,path){var styleElement,styleId;styleId=_styleIdForPath(path);styleElement=$("#"+styleId);if(styleElement.length>0){styleElement.html(data);}else{$('<style></style>').attr('type','text/css').attr('id',styleId).attr('class','appliedCss').html(data).appendTo('head');}
return styleId;};_getAllPromises=function(masterPromise,dependentStyles){var allPromises,dependentPromises,dependentStyle;dependentPromises=[(function(){var _i,_len,_results;_results=[];for(_i=0,_len=dependentStyles.length;_i<_len;_i++){dependentStyle=dependentStyles[_i];_results.push(cssPromiseManager.getPromise(dependentStyle,$.requireCss));}
return _results;})()];allPromises=U.flatten([masterPromise,dependentPromises]);return allPromises;};removeCss=function(path){var styleId;styleId=_styleIdForPath(path);$("head style[id=\""+styleId+"\"]").remove();return styleId;};requireCss=function(path,dependentStyles,async){var allPromises,cssPromise,fail,masterPromise,success,url;if(dependentStyles==null){dependentStyles=[];}
if(async==null){async=true;}
url="stylesheets/"+path+".css?"+(new Date().getTime());cssPromise=$.ajax({url:url,async:async});fail=function(){cssPromise.status='failed';cssPromise.failureReason="Failed to load css "+path+" with dependencies ["+(dependentStyles.join(', '))+"]";return OF.log(cssPromise.failureReason);};success=function(responseCss){cssPromise.status='success';if($.isArray(responseCss)){responseCss=responseCss[0];}
return _applyCss(responseCss,path);};if((dependentStyles!=null?dependentStyles.length:void 0)>0){masterPromise=cssPromise;allPromises=_getAllPromises(masterPromise,dependentStyles);cssPromise=$.when.apply($,allPromises);}
cssPromise.status='initialized';cssPromise.then(success,fail);cssPromiseManager.set(path,cssPromise);return cssPromise;};loadCss=function(path,async){return requireCss(path,null,async);};$.extend(requireCss,{_applyCss:_applyCss,_styleIdForPath:_styleIdForPath,_getAllPromises:_getAllPromises});return $.extend($,{requireCss:requireCss,loadCss:loadCss,removeCss:removeCss});})(jQuery);jQuery.urlEncode=function(options,prefix){var key,paramName,result,value,values;result='';if(options){values=[];for(key in options){if(!__hasProp.call(options,key))continue;value=options[key];if(value!=null){paramName=prefix?""+prefix+"["+key+"]":key;if($.isPlainObject(value)){values.push($.urlEncode(value,paramName));}else{values.push(""+paramName+"="+(encodeURIComponent(value)));}}}
result=values.join('&');}
return result;};jQuery.urlDecode=function(queryString){var pair,pairs,result,_i,_len;if(queryString==null){return;}
queryString=queryString.replace(/^\?/,'');result={};pairs=queryString.split('&');for(_i=0,_len=pairs.length;_i<_len;_i++){pair=pairs[_i];pair=pair.split('=');result[pair[0]]=decodeURIComponent(pair[1]);}
return result;};jQuery.jsonifyUrl=function(url){if(!url.match(/\.json/)){if(url.match(/\?/)){url=url.replace(/\?/,'.json?');}else{url+='.json';}}
return url;};jQuery.functionize=(function(){var errorLocation;errorLocation=function(file,name){return""+(file.replace('.json',''))+":"+name;};return function(js,file,name){if($.isFunction(js)){return js;}else if(typeof js==='string'){js=js.match(/^\s*function/)?"("+js+")":"(function($) {\n  $ = $ || jQuery;\n  "+js+"\n})";try{return eval(js);}catch(e){throw""+(e.toString())+" in "+(errorLocation(file,name));}}else{throw"ERROR: "+(errorLocation(file,name))+" Must be a string or function but was: "+js;}};})();jQuery.profile=function(name,fn){var end,retVal,start;start=new Date();retVal=fn();end=new Date();OF.log("JS PROFILE: "+name+" - "+(end-start)+"ms");return retVal;};jQuery.random=function(min,max){return Math.floor(Math.random()*(max+1-min))+min;};jQuery.deprecate=function(fn,oldName,newName){return function(){OF.log("DEPRECATION WARNING: "+oldName+" has been replaced by "+newName);return fn.apply(this,arguments);};};jQuery.submitFormByKeyboard=function(inputClass){if(inputClass==null){inputClass='.input_field';}
return $("form "+inputClass).keyup(function(event){if(event.keyCode===13){return $(this).blur().closest('form').submit();}});};Function.prototype.curry=function(){var args;args=1<=arguments.length?__slice.call(arguments,0):[];if(args.length===0){return this;}
return U.bind.apply(U,[this,this].concat(__slice.call(args)));};OF.EventEmitter=(function(){function EventEmitter(){}
EventEmitter.prototype.on=function(name,fnc){var _base;this.listeners||(this.listeners={});(_base=this.listeners)[name]||(_base[name]=[]);return this.listeners[name].push(fnc);};EventEmitter.prototype.off=function(name,fnc){var _ref;if((_ref=this.listeners)!=null?_ref[name]:void 0){if(fnc!=null){return this.listeners[name]=U(this.listeners[name]).without(fnc);}else{return this.listeners[name]=[];}}};EventEmitter.prototype.emit=function(){var args,fnc,name,_i,_len,_ref,_ref2,_results;name=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];if((_ref=this.listeners)!=null?_ref[name]:void 0){_ref2=this.listeners[name];_results=[];for(_i=0,_len=_ref2.length;_i<_len;_i++){fnc=_ref2[_i];_results.push(fnc.apply(this,args));}
return _results;}};return EventEmitter;})();OF.instanceMixin=function(){var instance,module,modules,_i,_len,_results;instance=arguments[0],modules=2<=arguments.length?__slice.call(arguments,1):[];_results=[];for(_i=0,_len=modules.length;_i<_len;_i++){module=modules[_i];_results.push(U.extend(instance,module.prototype));}
return _results;};OF.mixin=function(){var clazz,module,modules,_i,_len,_results;clazz=arguments[0],modules=2<=arguments.length?__slice.call(arguments,1):[];_results=[];for(_i=0,_len=modules.length;_i<_len;_i++){module=modules[_i];_results.push(U.extend(clazz.prototype,module.prototype));}
return _results;};}).call(this);